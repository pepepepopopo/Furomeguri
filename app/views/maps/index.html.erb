<div class="relative h-screen w-screen">
<div class="relative h-screen w-screen">
  <form class="absolute top-4 left-1/2 transform -translate-x-1/2 z-10 w-3/4 px-4">
    <div class="flex space-x-2">
      <div class="relative dropdown-container">
        <button type="button" class="dropdown-button py-2.5 px-4 bg-gray-100 border border-gray-300 rounded-lg text-sm">
          すべて含む
        </button>
        <div class="dropdown-menu hidden absolute mt-1 w-44 bg-white rounded-lg shadow z-20">
          <ul class="text-sm text-gray-700">
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢1</button></li>
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢2</button></li>
          </ul>
        </div>
      </div>

      <div class="relative dropdown-container">
        <button type="button" class="dropdown-button py-2.5 px-4 bg-gray-100 border border-gray-300 rounded-lg text-sm">
          すべて含む
        </button>
        <div class="dropdown-menu hidden absolute mt-1 w-44 bg-white rounded-lg shadow z-20">
          <ul class="text-sm text-gray-700">
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢A</button></li>
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢B</button></li>
          </ul>
        </div>
      </div>

      <div class="relative dropdown-container">
        <button type="button" class="dropdown-button py-2.5 px-4 bg-gray-100 border border-gray-300 rounded-lg text-sm">
          すべて含む
        </button>
        <div class="dropdown-menu hidden absolute mt-1 w-44 bg-white rounded-lg shadow z-20">
          <ul class="text-sm text-gray-700">
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢X</button></li>
            <li><button type="button" class="block w-full text-left px-4 py-2 hover:bg-gray-100">選択肢Y</button></li>
          </ul>
        </div>
      </div>

      <!-- 検索ボックス -->
      <div class="relative w-full">
        <input type="search" class="block p-2.5 w-full text-sm bg-gray-50 border border-gray-300 rounded-lg" placeholder="検索..." required />
        <button type="submit" class="absolute top-0 end-0 p-2.5 text-white bg-blue-700 rounded-r-lg hover:bg-blue-800">
          🔍
        </button>
      </div>
    </div>
  </form>
</div>


  <div class="absolute inset-0 z-0" id='map'></div>
</div>

<script>
  document.addEventListener('click', (e) => {
    const isDropdownButton = e.target.closest('.dropdown-button');
    const containers = document.querySelectorAll('.dropdown-container');

    containers.forEach(container => {
      const menu = container.querySelector('.dropdown-menu');
      if (container.contains(e.target) && isDropdownButton) {
        menu.classList.toggle('hidden');
      } else {
        menu.classList.add('hidden');
      }
    });
  });
</script>

<!-- Google Maps API -->
<script
src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap&v=weekly&libraries=marker"
defer></script>
<!-- MarkerClusterer CDN -->
<script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>

<script>
let map;

const locations = [
  { name: "草津", lat: 36.62303436838449, lng:138.59697281955727 },
  { name: "箱根", lat: 35.24343940136944, lng:139.0202909532175 },
  { name: "別府", lat: 33.31614938103781, lng:131.47085516768604 },
  { name: "下呂", lat: 35.80783558290318, lng:137.2417343342305 },
  { name: "熱海", lat: 35.099323, lng: 139.077021 },
  { name: "有馬", lat: 34.796697, lng: 135.248605 },
  { name: "道後", lat: 33.852328, lng: 132.785225 },
  { name: "登別", lat: 42.495801, lng: 141.147003 },
  { name: "由布院", lat: 33.263889, lng: 131.359722 },
]

async function initMap() {
  const { Map } = await google.maps.importLibrary("maps");
  const { AdvancedMarkerElement, PinElement } = await google.maps.importLibrary("marker");
  const glyphImg = document.createElement("img");
    map = new Map(document.getElementById("map"), {
    center: {lat: 35.68125718370711, lng:139.7665076889907},
    zoom: 6,
    mapId: 'DEMO_MAP_ID',
  });

  locations.map(location => {
    const pinCustom = new PinElement({
      glyphColor: 'white',
    });
    const marker = new AdvancedMarkerElement({
      map: map,
      position: {lat: location.lat, lng: location.lng },
      content: pinCustom.element,
    });
  });
};
</script>
